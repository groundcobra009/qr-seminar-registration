# QRコードセミナー受付システム - 実行手順（簡単版）

## 🎯 **今すぐやること（5ステップ）**

### **Step 1: デプロイ** ⏱️ 1分
1. GASエディタ右上の「**デプロイ**」→「**新しいデプロイ**」
2. 種類：「**ウェブアプリ**」
3. アクセス：「**全員**」
4. 「**デプロイ**」をクリック
5. **📋 ウェブアプリURLをコピーして保存**

### **Step 2: システム設定** ⏱️ 2分
**方法1: 自動設定（推奨）**
1. **スプレッドシートを開く**
2. **メニューバーの「QRコードセミナー受付システム」→「デプロイエンドポイント設定」**
3. **確認ダイアログで「OK」をクリック**

**方法2: 手動設定**
1. **メニューバーの「QRコードセミナー受付システム」→「システム設定」**
2. **スプレッドシートIDを入力**（URLの`/d/`と`/edit`の間の部分）
3. **シート名を入力**（デフォルト: シート1）
4. **デプロイエンドポイントを入力**（Step1で取得したWebアプリURL）
5. **「保存」をクリック**

### **Step 3: URL生成** ⏱️ 30秒
1. **メニューバーの「QRコードセミナー受付システム」→「URL一括生成」**
2. **確認ダイアログで「OK」をクリック**
3. **✅ スプレッドシートF列にURLが生成される**

### **Step 4: テスト** ⏱️ 1分
1. **F列のURLを1つコピー**
2. **ブラウザで開く**
3. **✅ 受付完了画面が表示される**
4. **✅ I列の「受付」がTRUEになる**

### **Step 5: QRコード生成（オプション）** ⏱️ 30秒
**方法1: 自動生成**
- メニュー「QRコード生成」から選択：
  - 📱 標準QRコード (200x200) - 一般的なサイズ
  - 📱 大きいQRコード (300x300) - より見やすい大きさ
  - 📱 高品質QRコード (エラー訂正H) - 汚れや損傷に強い

**方法2: 手動入力**
G列に以下の数式を入力：
```
=IMAGE("https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=" & ENCODEURL(F2))
```

**カスタマイズ例**:
```
=IMAGE("https://api.qrserver.com/v1/create-qr-code/?size=300x300&ecc=H&color=000080&bgcolor=f0f0f0&data=" & ENCODEURL(F2))
```
（300x300サイズ、高エラー訂正、紺色QR、薄灰色背景）

### **Step 6: 運用開始** 🎉
- **参加者にQRコードまたはURLを配布**
- **受付状況をメニューから確認**

---

## 🎛️ **メニュー機能**

### **📋 システム設定**
- スプレッドシートID、シート名、デプロイエンドポイントの設定
- 現在の設定確認

### **🚀 デプロイエンドポイント設定**
- 現在のWebアプリURLを自動設定
- 一発で正しいエンドポイントを設定

### **🔗 URL一括生成** 
- E列のトークンからF列にURL自動生成
- 生成件数を表示

### **📱 QRコード生成**
- **標準QRコード**: 200x200サイズ、基本品質
- **大きいQRコード**: 300x300サイズ、より見やすい
- **高品質QRコード**: 250x250サイズ、エラー訂正レベルH（損傷に強い）
- G列に画像として自動生成

### **📊 受付状況確認**
- 受付完了人数と受付率を表示
- リアルタイム確認

### **🔍 システムチェック**
- 重複トークンの検出
- データ整合性チェック

### **📖 使い方ガイド**
- システムの使い方を表示

---

## 🚨 **エラーが出た場合**

### **「スプレッドシートIDが設定されていません」**
→ メニューから「システム設定」を実行してIDを設定

### **「シートが見つかりません」**
→ システム設定でシート名を正しく設定

### **「URLアクセスでエラー」**
→ 1. デプロイ設定で「アクセスできるユーザー」が「全員」になっているか確認
→ 2. 「デプロイエンドポイント設定」を実行して正しいURLを設定

### **「URLが生成されない」**
→ E列にトークンが入力されているか確認

### **「URLは生成されるが、アクセスするとエラー」**
→ 「デプロイエンドポイント設定」を実行してから「URL一括生成」を再実行

---

## 📧 **メール送信機能**

### **受付完了メールの送信**
1. **事前確認**
   - QRコードが生成済み（G列に値があること）
   - 氏名（B列）とメールアドレス（D列）が入力済み
   - H列（返信）がFALSEの状態

2. **メール送信実行**
   - メニュー「📧 受付完了メール送信」をクリック
   - 送信結果ダイアログを確認

3. **送信内容**
   - 件名：[同窓会] 受付完了のお知らせ
   - 形式：HTMLメール（美しいレイアウト）
   - 本文：氏名入りの受付完了メッセージ
   - QRコード：メール内に直接画像表示

### **自動送信設定（オプション）**
1. Google Apps Scriptエディタで「トリガー」を開く
2. 「トリガーを追加」で以下を設定：
   - 実行する関数：`sendReceptionEmails`
   - イベントのソース：時間主導型
   - 間隔：1分おき（推奨）

### **送信状況確認**
- H列がTRUEになっていれば送信完了
- 送信エラーがあればダイアログで詳細表示

---

## ✅ **チェックリスト**
- [ ] Webアプリのデプロイ完了
- [ ] デプロイエンドポイントの設定完了
- [ ] システム設定完了（スプレッドシートID、シート名）
- [ ] URL一括生成完了（正しいエンドポイントで）
- [ ] URLアクセステスト成功（受付完了画面表示）
- [ ] QRコード生成完了（必要に応じて）
- [ ] メール送信テスト完了（テスト用データで確認）
- [ ] 自動送信トリガー設定完了（必要に応じて）
- [ ] 運用開始

**🎉 これで完了です！** 