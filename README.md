# QRコードセミナー受付システム

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Google Apps Script](https://img.shields.io/badge/Google%20Apps%20Script-4285F4?logo=google-apps-script&logoColor=white)](https://developers.google.com/apps-script)

QRコードを使用したセミナー受付システムです。Google Apps Script（GAS）とGoogle スプレッドシートを組み合わせて、参加者の受付を自動化します。

## 🌟 特徴

- **📱 QRコード自動生成**: 参加者ごとにユニークなQRコードを生成
- **✅ ワンクリック受付**: QRコードを読み取るだけで受付完了
- **📊 リアルタイム管理**: スプレッドシートで受付状況をリアルタイムに確認
- **📧 メール通知**: 受付完了メールを自動送信
- **🔒 セキュリティ**: トークンベースの認証で不正アクセスを防止
- **🎨 カスタマイズ可能**: QRコードのサイズや品質を調整可能

## 📋 必要な環境

- Google アカウント
- Google スプレッドシート
- Google Apps Script

## 🚀 クイックスタート

### 1. スプレッドシートの準備

以下の列構成でスプレッドシートを作成します：

| 列 | 項目名 | 説明 |
|---|--------|------|
| A | タイムスタンプ | 申込日時 |
| B | 氏名（フルネーム） | 参加者氏名 |
| C | 卒業年度 | 例：2001年 |
| D | メールアドレス | 連絡先 |
| E | トークン | 一意識別子（例：Ats52yp79rk1ov1u） |
| F | URL | 受付用URL（自動生成） |
| G | QR | QRコード画像 |
| H | 返信 | メール送信状態 |
| I | 受付 | 受付完了状態 |

### 2. Google Apps Scriptの設定

1. スプレッドシートから「拡張機能」→「Apps Script」を開く
2. `コード.js` の内容をコピー&ペースト
3. 新規HTMLファイル `settings.html` を作成し、内容をコピー&ペースト

### 3. デプロイ

1. GASエディタで「デプロイ」→「新しいデプロイ」をクリック
2. 種類：「ウェブアプリ」を選択
3. アクセス：「全員」に設定
4. デプロイをクリックし、表示されるWebアプリURLをコピー

### 4. システム設定

1. スプレッドシートのメニューから「QRコードセミナー受付システム」→「デプロイエンドポイント設定」
2. または「システム設定」から手動で設定

### 5. 運用開始

1. メニューから「URL一括生成」を実行
2. 「QRコード生成」でQRコードを作成
3. 参加者にQRコードまたはURLを配布

## 📱 主な機能

### システム管理

- **📋 システム設定**: スプレッドシートIDやシート名の設定
- **🚀 デプロイエンドポイント設定**: WebアプリURLの自動設定
- **🔗 URL一括生成**: トークンからURLを自動生成
- **📱 QRコード生成**: 3種類のQRコード生成オプション
  - 標準QRコード (200x200)
  - 大きいQRコード (300x300)
  - 高品質QRコード (エラー訂正レベルH)

### 受付管理

- **📊 受付状況確認**: リアルタイムで受付状況を確認
- **🔍 システムチェック**: データの整合性確認
- **📧 受付完了メール送信**: QRコード付きメールの自動送信

## 📧 メール送信機能

受付完了メールを自動送信する機能を搭載：

- QRコード画像を添付したHTMLメール
- 参加者名を含むパーソナライズされた内容
- 送信状況の管理（H列で管理）
- 一括送信または自動トリガー設定可能

## 🛠️ カスタマイズ

### QRコードのカスタマイズ

G列に以下の数式を入力してカスタマイズ：

```excel
=IMAGE("https://api.qrserver.com/v1/create-qr-code/?size=300x300&ecc=H&color=000080&bgcolor=f0f0f0&data=" & ENCODEURL(F2))
```

パラメータ：
- `size`: QRコードサイズ
- `ecc`: エラー訂正レベル (L/M/Q/H)
- `color`: 前景色
- `bgcolor`: 背景色

## 🚨 トラブルシューティング

### よくある問題

1. **「スプレッドシートIDが設定されていません」**
   - メニューから「システム設定」を実行

2. **「URLアクセスでエラー」**
   - デプロイ設定で「全員」アクセスを確認
   - 「デプロイエンドポイント設定」を再実行

3. **「QRコードが表示されない」**
   - 「QRコード再生成」を実行

## 🔒 セキュリティ

- トークンベースの認証
- 重複受付防止機能
- アクセスログの記録
- エラーハンドリング

## 📝 ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 🤝 貢献

Issue や Pull Request は歓迎します。大きな変更を行う場合は、まず Issue を作成して変更内容について議論してください。

## 👥 作者

- 作成者: [あなたの名前]
- 連絡先: [あなたのメールアドレス]

## 🙏 謝辞

このプロジェクトは以下の技術を使用しています：

- [Google Apps Script](https://developers.google.com/apps-script)
- [Google Sheets API](https://developers.google.com/sheets/api)
- [QR Server](https://goqr.me/api/)