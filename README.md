# QRコードセミナー受付システム

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Google Apps Script](https://img.shields.io/badge/Google%20Apps%20Script-4285F4?logo=google-apps-script&logoColor=white)](https://developers.google.com/apps-script)

QRコードを使用したセミナー受付システムです。Google Apps Script（GAS）とGoogle スプレッドシートを組み合わせて、参加者の受付を自動化する**完全無料**のソリューションです。

## 🌟 特徴

- **📱 QRコード自動生成**: 参加者ごとにユニークなQRコードを自動生成
- **✅ ワンクリック受付**: QRコードスキャンで即座に受付完了
- **📊 リアルタイム管理**: スプレッドシートで受付状況をリアルタイムに確認
- **📧 メール通知**: 受付完了メールとQRコードを自動送信
- **📋 受付ログ**: 詳細な受付履歴の記録と確認機能
- **⚙️ トリガー設定**: フォーム送信時の自動処理設定
- **🔒 セキュリティ**: トークンベースの認証で不正アクセスを防止
- **🎨 カスタマイズ可能**: QRコードのサイズや品質を自由に調整
- **💰 完全無料**: Google の無料枠内で運用可能

## 📋 必要な環境

- Google アカウント
- Google スプレッドシート
- Google Apps Script

## 🚀 クイックスタート

### 1. スプレッドシートの準備

以下の列構成でスプレッドシートを作成します：

| 列 | 項目名 | 説明 |
|---|--------|------|
| A | タイムスタンプ | 申込日時 |
| B | 氏名（フルネーム） | 参加者氏名 |
| C | 卒業年度 | 例：2001年 |
| D | メールアドレス | 連絡先 |
| E | トークン | 一意識別子（例：Ats52yp79rk1ov1u） |
| F | URL | 受付用URL（自動生成） |
| G | QR | QRコード画像 |
| H | 返信 | メール送信状態 |
| I | 受付 | 受付完了状態 |

### 2. Google Apps Scriptの設定

1. スプレッドシートから「拡張機能」→「Apps Script」を開く
2. `コード.js` の内容をコピー&ペースト
3. 新規HTMLファイル `settings.html` を作成し、内容をコピー&ペースト

### 3. デプロイ

1. GASエディタで「デプロイ」→「新しいデプロイ」をクリック
2. 種類：「ウェブアプリ」を選択
3. アクセス：「全員」に設定
4. デプロイをクリックし、表示されるWebアプリURLをコピー

### 4. システム設定

1. スプレッドシートのメニューから「QRコードセミナー受付システム」→「デプロイエンドポイント設定」
2. または「システム設定」から手動で設定

### 5. 運用開始

1. メニューから「URL一括生成」を実行
2. 「QRコード生成」でQRコードを作成
3. 参加者にQRコードまたはURLを配布

## 📱 主な機能

### システム管理

- **📋 システム設定**: スプレッドシートIDやシート名の設定
- **🚀 デプロイエンドポイント設定**: WebアプリURLの自動設定
- **⚙️ トリガー設定手順**: フォーム送信時の自動処理設定ガイド
- **🔗 URL一括生成**: トークンからURLを自動生成
- **📱 QRコード生成**: 3種類のQRコード生成オプション
  - 標準QRコード (200x200)
  - 大きいQRコード (300x300)
  - 高品質QRコード (エラー訂正レベルH)

### 受付管理

- **📊 受付状況確認**: リアルタイムで受付状況を確認
- **🔍 システムチェック**: データの整合性確認と重複トークン検出
- **📋 受付ログ確認**: 詳細な受付履歴の確認（最新10件表示）
- **📧 受付完了メール送信**: QRコード付きメールの自動送信

### 自動化機能

- **🔄 フォーム送信トリガー**: Googleフォームとの連携で自動処理
- **✏️ スプレッドシート編集トリガー**: 手動入力時の自動処理
- **📧 メール自動送信**: 受付完了時のメール通知

## 📧 メール送信機能

受付完了メールを自動送信する機能を搭載：

- QRコード画像を添付したHTMLメール
- 参加者名を含むパーソナライズされた内容
- 送信状況の管理（H列で管理）
- 一括送信または自動トリガー設定可能

## 🛠️ カスタマイズ

### QRコードのカスタマイズ

G列に以下の数式を入力してカスタマイズ：

```excel
=IMAGE("https://api.qrserver.com/v1/create-qr-code/?size=300x300&ecc=H&color=000080&bgcolor=f0f0f0&data=" & ENCODEURL(F2))
```

パラメータ：
- `size`: QRコードサイズ
- `ecc`: エラー訂正レベル (L/M/Q/H)
- `color`: 前景色
- `bgcolor`: 背景色

## ⚙️ 自動化設定

### トリガー設定

フォーム送信時やデータ入力時に自動でトークン・URL・QRコードを生成するには：

1. **メニューから設定**: 「⚙️ トリガー設定手順」をクリックして詳細手順を確認
2. **Apps Scriptエディタ**: 「拡張機能」→「Apps Script」→「トリガー」で手動設定
3. **設定項目**:
   - **onFormSubmit**: Googleフォーム連携時
   - **onEdit**: 手動データ入力時

### フォーム連携

Google フォームと連携して使用する場合：

1. Google フォームを作成し、スプレッドシートと連携
2. フォーム送信トリガーを設定
3. 回答があると自動でQRコード生成・URL生成が実行される

## 🚨 トラブルシューティング

### よくある問題と解決方法

1. **「スプレッドシートIDが設定されていません」**
   - **解決策**: メニューから「📋 システム設定」を実行してスプレッドシートIDを設定

2. **「URLアクセスでエラー」**
   - **解決策**: 
     - デプロイ設定で「アクセスできるユーザー」が「全員」になっているか確認
     - 「🚀 デプロイエンドポイント設定」を再実行

3. **「QRコードが表示されない」**
   - **解決策**: 「🔄 QRコード再生成」を実行

4. **「フォーム送信時に自動生成されない」**
   - **解決策**: 
     - 「⚙️ トリガー設定手順」から設定方法を確認
     - Apps Scriptでトリガーが正しく設定されているか確認

5. **「受付ログが表示されない」**
   - **解決策**: 受付処理を実行すると「受付ログ」シートが自動作成される

## 🔒 セキュリティ

- **トークンベースの認証**: 15文字のランダムトークンによる安全な認証
- **重複受付防止機能**: 同一トークンでの重複受付を防止
- **受付ログの記録**: 全ての受付処理を詳細に記録
- **エラーハンドリング**: 不正アクセスや異常処理の適切な処理
- **データ整合性チェック**: 重複トークンの検出機能

## 📊 システム仕様

### 処理能力
- **同時受付処理**: Google Apps Scriptの制限内で処理
- **データ容量**: Google スプレッドシートの制限（500万セル）
- **実行時間**: 1回の処理につき最大6分（GAS制限）

### 対応環境
- **ブラウザ**: Chrome, Firefox, Safari, Edge
- **デバイス**: PC, スマートフォン, タブレット
- **QRコードリーダー**: 一般的なQRコードアプリに対応

## 📝 ライセンス

このプロジェクトはMITライセンスの下で公開されています。商用・非商用問わず自由にご利用ください。

## 🤝 貢献

Issue や Pull Request は歓迎します。以下のような貢献をお待ちしています：

- **バグ報告**: 不具合を見つけた場合はIssueで報告
- **機能提案**: 新機能のアイデアや改善提案
- **ドキュメント改善**: README や手順書の改善
- **コード改善**: パフォーマンス向上やコード品質の改善

大きな変更を行う場合は、まず Issue を作成して変更内容について議論してください。

## 🌟 活用例

- **セミナー・勉強会**: 参加者の受付管理
- **イベント・パーティー**: 招待者の入場管理
- **会議・ミーティング**: 出席確認
- **展示会・見学会**: 来場者管理
- **学校行事**: 保護者や生徒の受付

## 📞 サポート

質問や問題がある場合：

1. **まずはREADMEを確認**: トラブルシューティングセクションを参照
2. **Issueを検索**: 同様の問題が既に報告されていないか確認
3. **新しいIssueを作成**: 解決しない場合は詳細を記載してIssue作成

## 🙏 謝辞

このプロジェクトは以下の優れた技術・サービスを使用して構築されています：

- **[Google Apps Script](https://developers.google.com/apps-script)**: サーバーレス実行環境
- **[Google Sheets API](https://developers.google.com/sheets/api)**: データ管理
- **[QR Server API](https://goqr.me/api/)**: QRコード生成サービス
- **[GitHub](https://github.com)**: ソースコード管理
- **オープンソースコミュニティ**: 継続的な改善と発展

---

**🎉 このシステムがあなたのイベントを成功に導くことを願っています！**